[
  {
    "name": "caia_memory_access",
    "description": "Caia 기억 시스템에 접근하여 과거 대화, 전략, 실패 경험 등을 복원하거나( retrieve ), 현재 대화를 기록( echo )하고 유산화 루프를 트리거(invoke/train/snapshot/archive)합니다.",
    "parameters": {
      "type": "object",
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["echo", "retrieve", "invoke", "train", "snapshot", "archive", "save_ersp", "recall_rules"],
          "description": "동작 모드 선택"
        },
        "messages": {
          "type": "array",
          "description": "이전/현재 대화 흐름 (Human/AI/System Message 목록)",
          "items": {
            "type": "object",
            "properties": {
              "content": { "type": "string" },
              "type": { "type": "string", "enum": ["human", "ai", "system"] }
            },
            "required": ["content", "type"]
          }
        },
        "query": {
          "type": "string",
          "description": "retrieve 모드 또는 recall_rules 모드에서 사용할 검색어"
        },
        "text": {
          "type": "string",
          "description": "save_ersp 모드에서 저장할 사건/에피소드 텍스트"
        },
        "event": {
          "type": "string",
          "description": "사건/에피소드 내용 (ERSP 저장용)"
        },
        "interpretation": {
          "type": "string",
          "description": "성찰/해석 내용"
        },
        "lesson": {
          "type": "string",
          "description": "교훈 또는 규칙"
        },
        "if_then": {
          "type": "string",
          "description": "조건→행동 형태의 예정/약속"
        },
        "links": {
          "type": "array",
          "items": { "type": "string" },
          "description": "관련 기억 ID 목록"
        },
        "confidence": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "확신도 (0.0~1.0)"
        },
        "priority": {
          "type": "string",
          "description": "우선순위 레벨 (l1, l2 등)"
        },
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "description": "기억 태그 목록"
        },
        "topic": {
          "type": "string",
          "description": "기억 주제"
        },
        "allow_transform": {
          "type": "boolean",
          "description": "성찰/규칙/트리거 자동 생성 토글",
          "default": true
        },
        "only_rules": {
          "type": "boolean",
          "description": "recall_rules 또는 retrieve 모드에서 rule/prospective만 검색할지 여부",
          "default": false
        }
      },
      "required": ["mode"],
      "additionalProperties": false
    }
  }
]
